estion=function(i,r,u,f,e,o,s){var w=this,y,a,l,p;if(r.IsDraft)return null;if(!r.WebLink)return SharedLogHelper.LogError("buildMessageSuggestion",null,new Error("Missing web link")),null;if(y=r.From&&r.From.EmailAddress?r.From.EmailAddress.Name||r.From.EmailAddress.Address:null,a=r.Sender&&r.Sender.EmailAddress?r.Sender.EmailAddress.Name||r.Sender.EmailAddress.Address:null,!y&&!a)return SharedLogHelper.LogError("buildMessageSuggestion",null,new Error("No valid from or sender fields present")),null;var v=y||a,c=r.Subject,b=f=="SSEE",k=null;t.config.enableRichEmailPreview&&a&&(k=this.getProfilePictureIcon(r.Sender.EmailAddress.Address,this.getPersonIcon(r.Sender.EmailAddress.Name)));var d="OLE",h=t.createSuggestion(i,HitHighlightingParser.addMarkers(v,s),k,null,d,c||v,n.InstrumentedItem.createInstrumentedItem(u,d),b?8:12,u,!0),g=b?1:2;return this.setEmailContextMenuItems(h,r.ItemHexId,r.WebLink,g),h.click=function(){return w.launchEmail(r.ItemHexId,r.WebLink,g)},h.template=1,h.classNames.push("email","forceNoWrapOutsideTopResult","topResultTemplateInGroups"),h.primaryMetadata=HitHighlightingParser.addMarkers(c,s),h.secondaryMetadata=HitHighlightingParser.addMarkers(r.Preview,