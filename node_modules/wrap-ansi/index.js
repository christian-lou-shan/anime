indows-Client-Desktop-Required-WOW64-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-Client-Features-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="n34V2ZBq9h0gVgslHWRMUVlRsHZXLuWkb6nksLE1gBQ=" PayloadSize="302010575" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-Client-Features-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-Client-Features-WOW64-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="mW9neyM6n8dB/WfY0JQ0D9tLrEcAfueBm3zPgrqxxms=" PayloadSize="83624122" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-Client-Features-WOW64-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-EditionPack-Core-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="2ErmMbsxYReIihsetRpzCEkH1RE/+Uus65++sHCm/Zk=" PayloadSize="118227422" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-EditionPack-Core-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-EditionPack-Core-WOW64-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="46d0vG6CL/SYpjSLsB0izfTtZ+DXkMUV8IbfXeKdFmw=" PayloadSize="11824816" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-EditionPack-Core-WOW64-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-RegulatedPackages-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="EweDcvvcVdQ9JdngPXiqNTygiP3uHr0iC6ZK6VY+xs0=" PayloadSize="38436580" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-RegulatedPackages-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-RegulatedPackages-WOW64-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="z6HB5HW29cqhyqSS4FBw+RfXg/9lMGh1A5cXRciOuJo=" PayloadSize="19686602" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-RegulatedPackages-WOW64-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-Not-Supported-On-LTSB-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="MWKC+RV6ja8duk5RzVCPo0PN1KHTQn1z0uM7YRFZhzo=" PayloadSize="28060" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-Not-Supported-On-LTSB-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-Not-Supported-On-LTSB-WOW64-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="kaIFg7A8i+Akc1bbYy/sBPhG4/O3Ge0Mnf6lU8brHKQ=" PayloadSize="28423715" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-Not-Supported-On-LTSB-WOW64-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-Required-ShellExperiences-Desktop-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="ns+UNqBMJ8l+GLhEdDXocLQ13L3Ul5iFN7Dbhkz9PW4=" PayloadSize="7354840" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-Required-ShellExperiences-Desktop-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft-Windows-Required-ShellExperiences-Desktop-WOW64-Package" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="hvYCyFUhxssSUdaQj17TWaFkQZbsOALl/fe2Ju3pOOw=" PayloadSize="1569542" Path="UUP\Desktop\editionPackages\neutral\Microsoft-Windows-Required-ShellExperiences-Desktop-WOW64-Package.ESD" PayloadType="Canonical" />
      </Payload>
    </Package>
    <Package ID="amd64_Microsoft.ModernApps.Client.All" Version="10.0.19041.1">
      <Payload>
        <PayloadItem PayloadHash="drFMk7m/SHPHl2V/lGBr8SBxckFOIGF37XEFkWsWVTo=" PayloadSize="284731300) {
			if (options.wordWrap === false && rowLength < columns) {
				wrapWord(rows, word, columns);
				continue;
			}

			rows.push('');
		}

		if (rowLength + lengths[index] > columns && options.wordWrap === false) {
			wrapWord(rows, word, columns);
			continue;
		}

		rows[rows.length - 1] += word;
	}

	if (options.trim !== false) {
		rows = rows.map(row => stringVisibleTrimSpacesRight(row));
	}

	const pre = [...rows.join('\n')];

	for (const [index, character] of pre.entries()) {
		returnValue += character;

		if (ESCAPES.has(character)) {
			const {groups} = new RegExp(`(?:\\${ANSI_CSI}(?<code>\\d+)m|\\${ANSI_ESCAPE_LINK}(?<uri>.*)${ANSI_ESCAPE_BELL})`).exec(pre.slice(index).join('')) || {groups: {}};
			if (groups.code !== undefined) {
				const code = Number.parseFloat(groups.code);
				escapeCode = code === END_CODE ? undefined : code;
			} else if (groups.uri !== undefined) {
				escapeUrl = groups.uri.length === 0 ? undefined : groups.uri;
			}
		}

		const code = ansiStyles.codes.get(Number(escapeCode));

		if (pre[index + 1] === '\n') {
			if (escapeUrl) {
				returnValue += wrapAnsiHyperlink('');
			}

			if (escapeCode && code) {
				returnValue += wrapAnsiCode(code);
			}
		} else if (character === '\n') {
			if (escapeCode && code) {
				returnValue += wrapAnsiCode(escapeCode);
			}

			if (escapeUrl) {
				returnValue += wrapAnsiHyperlink(escapeUrl);
			}
		}
	}

	return returnValue;
};

// For each newline, invoke the method separately
export default function wrapAnsi(string, columns, options) {
	return String(string)
		.normalize()
		.replace(/\r\n/g, '\n')
		.split('\n')
		.map(line => exec(line, columns, options))
		.join('\n');
}
